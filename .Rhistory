# headers = c("City with 10Km Buffer", "City Cells", "Treated City Cells with 10Km Buffer", "Treated City Cells"),
title='Treatment Effect Estimates with Spatial Spillovers and Exposure Quartile',
depvar=F,
se.below = T,
drop=c("mean_temp", "mean_prec", "mean_wind", "lat",
"mean_ruggedness", "coast_city", "water_dist",
"coast_dist", "pw_dist", 'area', 'Constant', 'Log(Pop.)', 'log_pop'),
fontsize='small',
tex = T,
style.tex = style,
digits.stats=3,
# file="tables/v2/te_spillovers.tex",
# label = 'tab:te_spillovers',
notes=notes_all_countries,
replace=T
)
m5 = feols(log_pol ~ ..lze_t + ..c2 + log_pop | country + year + id,
cluster=~country + year + id,
data=hetdf %>% filter(!(id %in% c(281, 318))),
split = ~ `Exp. Density Quartile`)
etable(
m5,
fitstat=c('n', "r2", "ar2"),
digits=3,
# headers = c("City with 10Km Buffer", "City Cells", "Treated City Cells with 10Km Buffer", "Treated City Cells"),
title='Treatment Effect Estimates with Spatial Spillovers and Exposure Quartile',
depvar=F,
se.below = T,
drop=c("mean_temp", "mean_prec", "mean_wind", "lat",
"mean_ruggedness", "coast_city", "water_dist",
"coast_dist", "pw_dist", 'area', 'Constant', 'Log(Pop.)', 'log_pop'),
fontsize='small',
tex = T,
style.tex = style,
digits.stats=3,
# file="tables/v2/te_spillovers.tex",
# label = 'tab:te_spillovers',
notes=notes_all_countries,
replace=T
)
m5 = feols(log_pol ~ ..lze_t + ..c2 + log_pop | country + year + id,
cluster=~country + year + id,
data=hetdf %>% filter(!(id %in% c(281, 318, 86))),
split = ~ `Exp. Density Quartile`)
etable(
m5,
fitstat=c('n', "r2", "ar2"),
digits=3,
# headers = c("City with 10Km Buffer", "City Cells", "Treated City Cells with 10Km Buffer", "Treated City Cells"),
title='Treatment Effect Estimates with Spatial Spillovers and Exposure Quartile',
depvar=F,
se.below = T,
drop=c("mean_temp", "mean_prec", "mean_wind", "lat",
"mean_ruggedness", "coast_city", "water_dist",
"coast_dist", "pw_dist", 'area', 'Constant', 'Log(Pop.)', 'log_pop'),
fontsize='small',
tex = T,
style.tex = style,
digits.stats=3,
# file="tables/v2/te_spillovers.tex",
# label = 'tab:te_spillovers',
notes=notes_all_countries,
replace=T
)
m5 = feols(log_pol ~ ..lze_t + ..c2 + log_pop | country + year + id,
cluster=~country + year + id,
data=hetdf %>% filter(!(id %in% c(281, 318, 86))),
split = ~ `Exp. Density Quartile`)
etable(
m5,
fitstat=c('n', "r2", "ar2"),
digits=3,
# headers = c("City with 10Km Buffer", "City Cells", "Treated City Cells with 10Km Buffer", "Treated City Cells"),
title='Treatment Effect Estimates with Spatial Spillovers and Exposure Quartile',
depvar=F,
se.below = T,
drop=c("mean_temp", "mean_prec", "mean_wind", "lat",
"mean_ruggedness", "coast_city", "water_dist",
"coast_dist", "pw_dist", 'area', 'Constant', 'Log(Pop.)', 'log_pop'),
fontsize='small',
tex = T,
style.tex = style,
digits.stats=3,
# file="tables/v2/te_spillovers.tex",
# label = 'tab:te_spillovers',
notes=notes_all_countries,
replace=T
)
m5 = feols(log_pol ~ ..lze_t + ..c2 + log_pop | country + year + id,
cluster=~country + year + id,
data=hetdf %>% filter(!(id %in% c(281, 318, 86, 184))),
split = ~ `Exp. Density Quartile`)
etable(
m5,
fitstat=c('n', "r2", "ar2"),
digits=3,
# headers = c("City with 10Km Buffer", "City Cells", "Treated City Cells with 10Km Buffer", "Treated City Cells"),
title='Treatment Effect Estimates with Spatial Spillovers and Exposure Quartile',
depvar=F,
se.below = T,
drop=c("mean_temp", "mean_prec", "mean_wind", "lat",
"mean_ruggedness", "coast_city", "water_dist",
"coast_dist", "pw_dist", 'area', 'Constant', 'Log(Pop.)', 'log_pop'),
fontsize='small',
tex = T,
style.tex = style,
digits.stats=3,
# file="tables/v2/te_spillovers.tex",
# label = 'tab:te_spillovers',
notes=notes_all_countries,
replace=T
)
m5 = feols(log_pol ~ ..lze_t + ..c2 + log_pop | country + year + id,
cluster=~country + year + id,
data=hetd, #%>% filter(!(id %in% c(281, 318, 86, 184))),
split = ~ `Exp. Density Quartile`)
etable(
m5,
fitstat=c('n', "r2", "ar2"),
digits=3,
# headers = c("City with 10Km Buffer", "City Cells", "Treated City Cells with 10Km Buffer", "Treated City Cells"),
title='Treatment Effect Estimates with Spatial Spillovers and Exposure Quartile',
depvar=F,
se.below = T,
drop=c("mean_temp", "mean_prec", "mean_wind", "lat",
"mean_ruggedness", "coast_city", "water_dist",
"coast_dist", "pw_dist", 'area', 'Constant', 'Log(Pop.)', 'log_pop'),
fontsize='small',
tex = T,
style.tex = style,
digits.stats=3,
# file="tables/v2/te_spillovers.tex",
# label = 'tab:te_spillovers',
notes=notes_all_countries,
replace=T
)
m5 = feols(log_pol ~ ..lze_t + ..c2 + log_pop | country + year + id,
cluster=~country + year + id,
data=hetdf, #%>% filter(!(id %in% c(281, 318, 86, 184))),
split = ~ `Exp. Density Quartile`)
etable(
m5,
fitstat=c('n', "r2", "ar2"),
digits=3,
# headers = c("City with 10Km Buffer", "City Cells", "Treated City Cells with 10Km Buffer", "Treated City Cells"),
title='Treatment Effect Estimates with Spatial Spillovers and Exposure Quartile',
depvar=F,
se.below = T,
drop=c("mean_temp", "mean_prec", "mean_wind", "lat",
"mean_ruggedness", "coast_city", "water_dist",
"coast_dist", "pw_dist", 'area', 'Constant', 'Log(Pop.)', 'log_pop'),
fontsize='small',
tex = T,
style.tex = style,
digits.stats=3,
# file="tables/v2/te_spillovers.tex",
# label = 'tab:te_spillovers',
notes=notes_all_countries,
replace=T
)
hetdf = df %>% filter(id %in% treated_ids & city==1 & yeartreat >= 2007 & yeartreat <= 2021)
by = join_by(id)
hetdf = left_join(hetdf, auxfin, by=by)
m5 = feols(log_pol ~ ..lze_t + ..c2 + log_pop | country + year + id,
cluster=~country + year + id,
data=hetdf, #%>% filter(!(id %in% c(281, 318, 86, 184))),
split = ~ `Exp. Density Quartile`)
etable(
m5,
fitstat=c('n', "r2", "ar2"),
digits=3,
# headers = c("City with 10Km Buffer", "City Cells", "Treated City Cells with 10Km Buffer", "Treated City Cells"),
title='Treatment Effect Estimates with Spatial Spillovers and Exposure Quartile',
depvar=F,
se.below = T,
drop=c("mean_temp", "mean_prec", "mean_wind", "lat",
"mean_ruggedness", "coast_city", "water_dist",
"coast_dist", "pw_dist", 'area', 'Constant', 'Log(Pop.)', 'log_pop'),
fontsize='small',
tex = T,
style.tex = style,
digits.stats=3,
# file="tables/v2/te_spillovers.tex",
# label = 'tab:te_spillovers',
notes=notes_all_countries,
replace=T
)
m5 = feols(log_pol ~ ..lze_t + ..c2 + log_pop | country + year + id,
vcov=vcov_arg, #cluster=~country + year + id,
data=hetdf, #%>% filter(!(id %in% c(281, 318, 86, 184))),
split = ~ `Exp. Density Quartile`)
etable(
m5,
fitstat=c('n', "r2", "ar2"),
digits=3,
# headers = c("City with 10Km Buffer", "City Cells", "Treated City Cells with 10Km Buffer", "Treated City Cells"),
title='Treatment Effect Estimates with Spatial Spillovers and Exposure Quartile',
depvar=F,
se.below = T,
drop=c("mean_temp", "mean_prec", "mean_wind", "lat",
"mean_ruggedness", "coast_city", "water_dist",
"coast_dist", "pw_dist", 'area', 'Constant', 'Log(Pop.)', 'log_pop'),
fontsize='small',
tex = T,
style.tex = style,
digits.stats=3,
# file="tables/v2/te_spillovers.tex",
# label = 'tab:te_spillovers',
notes=notes_all_countries,
replace=T
)
hetdf %>%
filter(timetotreat %in% tyears) %>%
select(vector, timetotreat, pop, pol) %>%
gather("Type", "Implemented", lze:lze_10_25) %>%
group_by(Type, Implemented, timetotreat) %>%
summarise(avg=weighted.mean(pol, pop)) %>%
mutate(
Implemented=factor(Implemented),
Type=case_when(
Type == 'lze' ~ "LEZ",
Type == 'lze_0_1' ~ "1km Spillover",
Type == 'lze_1_3' ~ "1-3km Spillover",
Type == 'lze_3_5' ~ "3-5km Spillover",
Type == 'lze_5_10' ~ "5-10km Spillover",
Type == 'lze_10_25' ~ "10-25km Spillover",
)
) %>%
rename("Affected Cells"=Implemented) %>%
ggplot(aes(x=timetotreat, y=avg, color=`Affected Cells`))+
geom_line() +
theme_bw() +
geom_vline(xintercept=0, linetype="dashed", alpha=.4) +
facet_wrap(~factor(Type,
levels=c("LEZ", "1km Spillover", "1-3km Spillover",
"3-5km Spillover", "5-10km Spillover", "10-25km Spillover"))) +
ylab("PM2.5 Weighted Exposure") +
xlab("Time to LEZ Implementation")+
ggtitle("All Grid Cells inside Treated Cities")+
theme(text=element_text(family="Palatino"))
tyears = seq(-5, 5, 1)
vector = c("lze", "lze_0_1", "lze_1_3", "lze_3_5", "lze_5_10", "lze_10_25")
hetdf %>%
filter(timetotreat %in% tyears) %>%
select(vector, timetotreat, pop, pol) %>%
gather("Type", "Implemented", lze:lze_10_25) %>%
group_by(Type, Implemented, timetotreat) %>%
summarise(avg=weighted.mean(pol, pop)) %>%
mutate(
Implemented=factor(Implemented),
Type=case_when(
Type == 'lze' ~ "LEZ",
Type == 'lze_0_1' ~ "1km Spillover",
Type == 'lze_1_3' ~ "1-3km Spillover",
Type == 'lze_3_5' ~ "3-5km Spillover",
Type == 'lze_5_10' ~ "5-10km Spillover",
Type == 'lze_10_25' ~ "10-25km Spillover",
)
) %>%
rename("Affected Cells"=Implemented) %>%
ggplot(aes(x=timetotreat, y=avg, color=`Affected Cells`))+
geom_line() +
theme_bw() +
geom_vline(xintercept=0, linetype="dashed", alpha=.4) +
facet_wrap(~factor(Type,
levels=c("LEZ", "1km Spillover", "1-3km Spillover",
"3-5km Spillover", "5-10km Spillover", "10-25km Spillover"))) +
ylab("PM2.5 Weighted Exposure") +
xlab("Time to LEZ Implementation")+
ggtitle("All Grid Cells inside Treated Cities")+
theme(text=element_text(family="Palatino"))
hetdf %>%
filter(timetotreat %in% tyears) %>%
select(vector, timetotreat, pop, pol) %>%
gather("Type", "Implemented", lze:lze_10_25) %>%
group_by(Type, Implemented, timetotreat) %>%
summarise(avg=weighted.mean(pol, pop)) %>%
mutate(
Implemented=factor(Implemented),
Type=case_when(
Type == 'lze' ~ "LEZ",
Type == 'lze_0_1' ~ "1km Spillover",
Type == 'lze_1_3' ~ "1-3km Spillover",
Type == 'lze_3_5' ~ "3-5km Spillover",
Type == 'lze_5_10' ~ "5-10km Spillover",
Type == 'lze_10_25' ~ "10-25km Spillover",
)
) %>%
rename("Affected Cells"=Implemented) %>%
ggplot(aes(x=timetotreat, y=avg, color=`Affected Cells`))+
geom_line() +
theme_bw() +
geom_vline(xintercept=0, linetype="dashed", alpha=.4) +
facet_wrap(`Density Quartile`~factor(Type,
levels=c("LEZ", "1km Spillover", "1-3km Spillover",
"3-5km Spillover", "5-10km Spillover", "10-25km Spillover"))) +
ylab("PM2.5 Weighted Exposure") +
xlab("Time to LEZ Implementation")+
ggtitle("All Grid Cells inside Treated Cities")+
theme(text=element_text(family="Palatino"))
hetdf %>%
filter(id==281)
hetdf %>%
filter(id==281) %>%
filter(timetotreat %in% tyears) %>%
select(vector, timetotreat, pop, pol) %>%
gather("Type", "Implemented", lze:lze_10_25) %>%
group_by(Type, Implemented, timetotreat) %>%
summarise(avg=weighted.mean(pol, pop)) %>%
mutate(
Implemented=factor(Implemented),
Type=case_when(
Type == 'lze' ~ "LEZ",
Type == 'lze_0_1' ~ "1km Spillover",
Type == 'lze_1_3' ~ "1-3km Spillover",
Type == 'lze_3_5' ~ "3-5km Spillover",
Type == 'lze_5_10' ~ "5-10km Spillover",
Type == 'lze_10_25' ~ "10-25km Spillover",
)
) %>%
rename("Affected Cells"=Implemented) %>%
ggplot(aes(x=timetotreat, y=avg, color=`Affected Cells`))+
geom_line() +
theme_bw() +
geom_vline(xintercept=0, linetype="dashed", alpha=.4) +
facet_wrap(~factor(Type,
levels=c("LEZ", "1km Spillover", "1-3km Spillover",
"3-5km Spillover", "5-10km Spillover", "10-25km Spillover"))) +
ylab("PM2.5 Weighted Exposure") +
xlab("Time to LEZ Implementation")+
ggtitle("All Grid Cells inside Treated Cities")+
theme(text=element_text(family="Palatino"))
hetdf %>%
filter(id==86) %>%
filter(timetotreat %in% tyears) %>%
select(vector, timetotreat, pop, pol) %>%
gather("Type", "Implemented", lze:lze_10_25) %>%
group_by(Type, Implemented, timetotreat) %>%
summarise(avg=weighted.mean(pol, pop)) %>%
mutate(
Implemented=factor(Implemented),
Type=case_when(
Type == 'lze' ~ "LEZ",
Type == 'lze_0_1' ~ "1km Spillover",
Type == 'lze_1_3' ~ "1-3km Spillover",
Type == 'lze_3_5' ~ "3-5km Spillover",
Type == 'lze_5_10' ~ "5-10km Spillover",
Type == 'lze_10_25' ~ "10-25km Spillover",
)
) %>%
rename("Affected Cells"=Implemented) %>%
ggplot(aes(x=timetotreat, y=avg, color=`Affected Cells`))+
geom_line() +
theme_bw() +
geom_vline(xintercept=0, linetype="dashed", alpha=.4) +
facet_wrap(~factor(Type,
levels=c("LEZ", "1km Spillover", "1-3km Spillover",
"3-5km Spillover", "5-10km Spillover", "10-25km Spillover"))) +
ylab("PM2.5 Weighted Exposure") +
xlab("Time to LEZ Implementation")+
ggtitle("All Grid Cells inside Treated Cities")+
theme(text=element_text(family="Palatino"))
hetdf %>%
filter(`Density Quartile`="Q4") %>%
filter(timetotreat %in% tyears) %>%
select(vector, timetotreat, pop, pol) %>%
gather("Type", "Implemented", lze:lze_10_25) %>%
group_by(Type, Implemented, timetotreat) %>%
summarise(avg=weighted.mean(pol, pop)) %>%
mutate(
Implemented=factor(Implemented),
Type=case_when(
Type == 'lze' ~ "LEZ",
Type == 'lze_0_1' ~ "1km Spillover",
Type == 'lze_1_3' ~ "1-3km Spillover",
Type == 'lze_3_5' ~ "3-5km Spillover",
Type == 'lze_5_10' ~ "5-10km Spillover",
Type == 'lze_10_25' ~ "10-25km Spillover",
)
) %>%
rename("Affected Cells"=Implemented) %>%
ggplot(aes(x=timetotreat, y=avg, color=`Affected Cells`))+
geom_line() +
theme_bw() +
geom_vline(xintercept=0, linetype="dashed", alpha=.4) +
facet_wrap(~factor(Type,
levels=c("LEZ", "1km Spillover", "1-3km Spillover",
"3-5km Spillover", "5-10km Spillover", "10-25km Spillover"))) +
ylab("PM2.5 Weighted Exposure") +
xlab("Time to LEZ Implementation")+
ggtitle("All Grid Cells inside Treated Cities")+
theme(text=element_text(family="Palatino"))
hetdf %>%
filter(`Density Quartile`=="Q4") %>%
filter(timetotreat %in% tyears) %>%
select(vector, timetotreat, pop, pol) %>%
gather("Type", "Implemented", lze:lze_10_25) %>%
group_by(Type, Implemented, timetotreat) %>%
summarise(avg=weighted.mean(pol, pop)) %>%
mutate(
Implemented=factor(Implemented),
Type=case_when(
Type == 'lze' ~ "LEZ",
Type == 'lze_0_1' ~ "1km Spillover",
Type == 'lze_1_3' ~ "1-3km Spillover",
Type == 'lze_3_5' ~ "3-5km Spillover",
Type == 'lze_5_10' ~ "5-10km Spillover",
Type == 'lze_10_25' ~ "10-25km Spillover",
)
) %>%
rename("Affected Cells"=Implemented) %>%
ggplot(aes(x=timetotreat, y=avg, color=`Affected Cells`))+
geom_line() +
theme_bw() +
geom_vline(xintercept=0, linetype="dashed", alpha=.4) +
facet_wrap(~factor(Type,
levels=c("LEZ", "1km Spillover", "1-3km Spillover",
"3-5km Spillover", "5-10km Spillover", "10-25km Spillover"))) +
ylab("PM2.5 Weighted Exposure") +
xlab("Time to LEZ Implementation")+
ggtitle("All Grid Cells inside Treated Cities")+
theme(text=element_text(family="Palatino"))
hetdf %>%
filter(`Density Quartile`=="Q2") %>%
filter(timetotreat %in% tyears) %>%
select(vector, timetotreat, pop, pol) %>%
gather("Type", "Implemented", lze:lze_10_25) %>%
group_by(Type, Implemented, timetotreat) %>%
summarise(avg=weighted.mean(pol, pop)) %>%
mutate(
Implemented=factor(Implemented),
Type=case_when(
Type == 'lze' ~ "LEZ",
Type == 'lze_0_1' ~ "1km Spillover",
Type == 'lze_1_3' ~ "1-3km Spillover",
Type == 'lze_3_5' ~ "3-5km Spillover",
Type == 'lze_5_10' ~ "5-10km Spillover",
Type == 'lze_10_25' ~ "10-25km Spillover",
)
) %>%
rename("Affected Cells"=Implemented) %>%
ggplot(aes(x=timetotreat, y=avg, color=`Affected Cells`))+
geom_line() +
theme_bw() +
geom_vline(xintercept=0, linetype="dashed", alpha=.4) +
facet_wrap(~factor(Type,
levels=c("LEZ", "1km Spillover", "1-3km Spillover",
"3-5km Spillover", "5-10km Spillover", "10-25km Spillover"))) +
ylab("PM2.5 Weighted Exposure") +
xlab("Time to LEZ Implementation")+
ggtitle("All Grid Cells inside Treated Cities")+
theme(text=element_text(family="Palatino"))
hetdf %>%
# filter(`Density Quartile`=="Q2") %>%
filter(timetotreat %in% tyears) %>%
select(vector, timetotreat, pop, pol) %>%
gather("Type", "Implemented", lze:lze_10_25) %>%
group_by(Type, Implemented, timetotreat) %>%
summarise(avg=weighted.mean(pol, pop)) %>%
mutate(
Implemented=factor(Implemented),
Type=case_when(
Type == 'lze' ~ "LEZ",
Type == 'lze_0_1' ~ "1km Spillover",
Type == 'lze_1_3' ~ "1-3km Spillover",
Type == 'lze_3_5' ~ "3-5km Spillover",
Type == 'lze_5_10' ~ "5-10km Spillover",
Type == 'lze_10_25' ~ "10-25km Spillover",
)
) %>%
rename("Affected Cells"=Implemented) %>%
ggplot(aes(x=timetotreat, y=avg, color=`Affected Cells`))+
geom_line() +
theme_bw() +
geom_vline(xintercept=0, linetype="dashed", alpha=.4) +
facet_wrap(~factor(Type,
levels=c("LEZ", "1km Spillover", "1-3km Spillover",
"3-5km Spillover", "5-10km Spillover", "10-25km Spillover"))) +
ylab("PM2.5 Weighted Exposure") +
xlab("Time to LEZ Implementation")+
ggtitle("All Grid Cells inside Treated Cities")+
theme(text=element_text(family="Palatino"))
hetdf %>%
# filter(`Density Quartile`=="Q2") %>%
filter(timetotreat %in% tyears) %>%
select(vector, timetotreat, pop, pol) %>%
gather("Type", "Implemented", lze:lze_10_25) %>%
group_by(Type, Implemented, timetotreat) %>%
summarise(avg=weighted.mean(pol, pop)) %>%
mutate(
Implemented=factor(Implemented),
Type=case_when(
Type == 'lze' ~ "LEZ",
Type == 'lze_0_1' ~ "1km Spillover",
Type == 'lze_1_3' ~ "1-3km Spillover",
Type == 'lze_3_5' ~ "3-5km Spillover",
Type == 'lze_5_10' ~ "5-10km Spillover",
Type == 'lze_10_25' ~ "10-25km Spillover",
)
) %>%
rename("Affected Cells"=Implemented) %>%
ggplot(aes(x=timetotreat, y=avg, color=`Affected Cells`))+
geom_line() +
theme_bw() +
geom_vline(xintercept=0, linetype="dashed", alpha=.4) +
facet_wrap(~factor(Type,
levels=c("LEZ", "1km Spillover", "1-3km Spillover",
"3-5km Spillover", "5-10km Spillover", "10-25km Spillover"))) +
ylab("PM2.5 Weighted Exposure") +
xlab("Time to LEZ Implementation")+
ggtitle("All Grid Cells inside Treated Cities")+
theme(text=element_text(family="Palatino"))
